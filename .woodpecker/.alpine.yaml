skip_clone: false

steps:
  - name: build
    when:
      branch: [master]
      event: [push, tag, manual]
    image: alpine:edge
    commands:
      - apk add --no-cache go make golangci-lint
      - make
      - sh ./scripts/lint.sh
  - name: release
    when:
      branch: [master]
      event: [tag]
    image: woodpeckerci/plugin-release
    settings:
      files:
        - 'cca'
      api_key:
        from_secret: FORGEJO_API_KEY
